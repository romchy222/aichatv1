<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">
    <title>AI –ü–æ–º–æ—â–Ω–∏–∫ Pro - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —á–∞—Ç</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{% load static %}{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% load static %}{% static 'css/enhanced-chat.css' %}" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">
</head>
<body>
    <div class="container-fluid enhanced-chat-app">
        <!-- Enhanced Sidebar -->
        <div class="enhanced-sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <i class="fas fa-robot"></i>
                    AI –ü–æ–º–æ—â–Ω–∏–∫ Pro
                    <span class="version-badge">v2.0</span>
                </div>
                <div class="sidebar-controls">
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="sidebar-menu-btn" id="sidebar-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
            
            <!-- Project Selector -->
            <div class="project-section">
                <div class="section-title">
                    <i class="fas fa-folder"></i>
                    –ü—Ä–æ–µ–∫—Ç—ã
                </div>
                <div class="project-selector-container">
                    <select id="project-selector" class="form-select project-selector">
                        <option value="">–û–±—â–∏–π —á–∞—Ç</option>
                    </select>
                    <button class="btn btn-sm btn-outline-primary new-project-btn" id="new-project-btn">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            
            <!-- Chat History Search -->
            <div class="search-section">
                <div class="section-title">
                    <i class="fas fa-search"></i>
                    –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏
                </div>
                <div class="search-container">
                    <input type="text" id="history-search" class="form-control search-input" 
                           placeholder="–ü–æ–∏—Å–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö...">
                    <button class="search-btn" id="search-history-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div class="search-results" id="search-results"></div>
            </div>
            
            <!-- FAQ Search -->
            <div class="faq-search-section">
                <div class="section-title">
                    <i class="fas fa-question-circle"></i>
                    –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
                </div>
                <input type="text" id="faq-search" class="form-control faq-search-input" 
                       placeholder="–ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π...">
                <div class="faq-results" id="faq-results">
                    <div class="welcome-message">
                        <p>–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞</p>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="quick-actions-section">
                <div class="section-title">
                    <i class="fas fa-bolt"></i>
                    –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                </div>
                <div class="quick-actions">
                    <button class="btn btn-sm btn-outline-info" id="export-chat-btn">
                        <i class="fas fa-download"></i>
                        –≠–∫—Å–ø–æ—Ä—Ç —á–∞—Ç–∞
                    </button>
                    <button class="btn btn-sm btn-outline-success" id="summary-btn">
                        <i class="fas fa-list"></i>
                        –°–≤–æ–¥–∫–∞
                    </button>
                    <button class="btn btn-sm btn-outline-warning" id="mood-analysis-btn">
                        <i class="fas fa-smile"></i>
                        –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
                    </button>
                </div>
            </div>
            
            <!-- Chat Stats -->
            <div class="stats-section">
                <div class="section-title">
                    <i class="fas fa-chart-line"></i>
                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="message-count">0</span>
                        <span class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="voice-count">0</span>
                        <span class="stat-label">–ì–æ–ª–æ—Å–æ–≤—ã—Ö</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="file-count">0</span>
                        <span class="stat-label">–§–∞–π–ª–æ–≤</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Main Chat Area -->
        <div class="enhanced-chat-container">
            <!-- Enhanced Chat Header -->
            <div class="enhanced-chat-header">
                <div class="chat-title-section">
                    <button class="mobile-sidebar-toggle d-md-none" id="mobile-sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="chat-title-info">
                        <h1 class="chat-title">
                            <i class="fas fa-comments"></i>
                            AI –ü–æ–º–æ—â–Ω–∏–∫ Pro
                        </h1>
                        <div class="chat-subtitle" id="chat-subtitle">
                            –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —á–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≥–æ–ª–æ—Å–∞ –∏ —Ñ–∞–π–ª–æ–≤
                        </div>
                    </div>
                </div>
                
                <div class="chat-status-section">
                    <div class="status-indicators">
                        <div class="status-item">
                            <span class="status-indicator online"></span>
                            <span class="status-text">–û–Ω–ª–∞–π–Ω</span>
                        </div>
                        <div class="current-mood" id="current-mood" style="display: none;">
                            <span class="mood-emoji"></span>
                            <span class="mood-text"></span>
                        </div>
                    </div>
                    
                    <div class="header-actions">
                        <button class="btn btn-sm btn-outline-secondary" id="clear-chat-btn">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-primary" id="settings-btn">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Enhanced Messages Container -->
            <div class="enhanced-messages-container" id="messages-container">
                <div class="welcome-message" id="welcome-message">
                    <div class="welcome-content">
                        <h2>üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AI –ü–æ–º–æ—â–Ω–∏–∫ Pro!</h2>
                        <p>–Ø –≤–∞—à —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:</p>
                        
                        <div class="feature-highlights">
                            <div class="feature-item">
                                <i class="fas fa-microphone"></i>
                                <span>–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-image"></i>
                                <span>–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-folder"></i>
                                <span>–ü—Ä–æ–µ–∫—Ç—ã –∏ —Ç–µ–º—ã</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-heart"></i>
                                <span>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</span>
                            </div>
                        </div>
                        
                        <div class="welcome-suggestions">
                            <button class="suggestion-button" onclick="sendSuggestion('–ü–æ–∫–∞–∂–∏ –º–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã')">
                                üìÅ –ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã
                            </button>
                            <button class="suggestion-button" onclick="sendSuggestion('–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è?')">
                                üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                            </button>
                            <button class="suggestion-button" onclick="sendSuggestion('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞')">
                                üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                            </button>
                            <button class="suggestion-button" onclick="sendSuggestion('–ü–æ–º–æ—â—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏')">
                                üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Enhanced Input Area -->
            <div class="enhanced-input-area">
                <!-- File Drop Zone Overlay -->
                <div class="file-drop-overlay" id="file-drop-overlay">
                    <div class="drop-content">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
                        <p>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∞—É–¥–∏–æ</p>
                    </div>
                </div>
                
                <!-- Voice Recording Indicator -->
                <div class="voice-recording-indicator" id="voice-recording-indicator" style="display: none;">
                    <div class="recording-animation">
                        <div class="pulse"></div>
                        <i class="fas fa-microphone"></i>
                    </div>
                    <span>–ò–¥—ë—Ç –∑–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞...</span>
                    <button class="btn btn-sm btn-danger stop-recording" onclick="stopVoiceRecording()">
                        –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
                
                <!-- Main Input Container -->
                <div class="input-container">
                    <form id="chat-form" class="enhanced-chat-form">
                        <div class="input-wrapper">
                            <!-- Attachment Preview Area -->
                            <div class="attachment-preview" id="attachment-preview" style="display: none;"></div>
                            
                            <!-- Main Message Input -->
                            <div class="message-input-section">
                                <textarea id="message-input" 
                                         class="form-control message-input" 
                                         placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –∑–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                                         rows="1"></textarea>
                                
                                <!-- Input Tools -->
                                <div class="input-tools">
                                    <!-- File Attachment -->
                                    <button type="button" class="tool-btn" id="file-attach-btn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
                                        <i class="fas fa-paperclip"></i>
                                    </button>
                                    
                                    <!-- Voice Recording -->
                                    <button type="button" class="tool-btn voice-btn" id="voice-record-btn" title="–ì–æ–ª–æ—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å">
                                        <i class="fas fa-microphone"></i>
                                    </button>
                                    
                                    <!-- Image Upload -->
                                    <button type="button" class="tool-btn" id="image-upload-btn" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                                        <i class="fas fa-image"></i>
                                    </button>
                                    
                                    <!-- Send Button -->
                                    <button type="submit" class="send-btn" id="send-btn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hidden File Input -->
                        <input type="file" id="file-input" style="display: none;" 
                               accept="image/*,application/pdf,.doc,.docx,.txt,.xlsx,.csv" multiple>
                        
                        <!-- Hidden Image Input -->
                        <input type="file" id="image-input" style="display: none;" 
                               accept="image/*" multiple>
                    </form>
                </div>
                
                <!-- Input Footer -->
                <div class="input-footer">
                    <div class="typing-indicator" id="typing-indicator" style="display: none;">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span class="typing-text">AI –ø–µ—á–∞—Ç–∞–µ—Ç...</span>
                    </div>
                    
                    <div class="input-stats">
                        <span class="char-count" id="char-count">0/2000</span>
                        <span class="word-count" id="word-count">0 —Å–ª–æ–≤</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Enhanced Modals -->
    
    <!-- New Project Modal -->
    <div class="modal fade" id="newProjectModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="new-project-form">
                        <div class="mb-3">
                            <label for="project-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                            <input type="text" class="form-control" id="project-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="project-description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea class="form-control" id="project-description" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="project-type" class="form-label">–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞</label>
                            <select class="form-select" id="project-type">
                                <option value="general">–û–±—â–∏–π</option>
                                <option value="academic">–£—á—ë–±–∞</option>
                                <option value="research">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</option>
                                <option value="personal">–õ–∏—á–Ω–æ–µ</option>
                                <option value="work">–†–∞–±–æ—Ç–∞</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="project-color" class="form-label">–¶–≤–µ—Ç —Ç–µ–º—ã</label>
                            <input type="color" class="form-control form-control-color" id="project-color" value="#0D1B2A">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" id="create-project-btn">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Export Chat Modal -->
    <div class="modal fade" id="exportChatModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–≠–∫—Å–ø–æ—Ä—Ç –±–µ—Å–µ–¥—ã</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="export-options">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exportFormat" id="exportPDF" value="pdf" checked>
                            <label class="form-check-label" for="exportPDF">
                                <i class="fas fa-file-pdf text-danger"></i>
                                PDF –¥–æ–∫—É–º–µ–Ω—Ç
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exportFormat" id="exportWord" value="docx">
                            <label class="form-check-label" for="exportWord">
                                <i class="fas fa-file-word text-primary"></i>
                                Word –¥–æ–∫—É–º–µ–Ω—Ç
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="exportFormat" id="exportText" value="txt">
                            <label class="form-check-label" for="exportText">
                                <i class="fas fa-file-alt text-secondary"></i>
                                –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
                            </label>
                        </div>
                    </div>
                    
                    <div class="export-settings mt-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="includeTimestamps" checked>
                            <label class="form-check-label" for="includeTimestamps">
                                –í–∫–ª—é—á–∏—Ç—å –≤—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏–π
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="includeSystemMessages">
                            <label class="form-check-label" for="includeSystemMessages">
                                –í–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-success" id="download-export-btn">
                        <i class="fas fa-download"></i>
                        –°–∫–∞—á–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Image Preview Modal -->
    <div class="modal fade" id="imagePreviewModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="modal-image" class="img-fluid" alt="Preview">
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notifications Container -->
    <div class="notifications-container" id="notifications-container"></div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{% load static %}{% static 'js/themes.js' %}"></script>
    <script src="{% load static %}{% static 'js/enhanced-chat.js' %}"></script>
    <script src="{% load static %}{% static 'js/chat.js' %}"></script>
</body>
</html>